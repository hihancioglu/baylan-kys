/*** Data table component with sorting, sticky header, responsive wrapping,* pagination and selectable rows. Includes mock data (10k+ records),* ARIA roles and keyboard navigation.** HTMX integration:*   document.body.addEventListener('htmx:load', (evt) => {*     evt.target.querySelectorAll('[data-component="data-table"]').forEach(initDataTable);*   });*   // For static content:*   document.querySelectorAll('[data-component="data-table"]').forEach(initDataTable);*/export function initDataTable(root) {if (typeof root === 'string') {root = document.querySelector(root);}if (!root) return;const columns = [{ key: 'id', label: 'ID' },{ key: 'name', label: 'Name' },{ key: 'value', label: 'Value' },];const totalRows = 12000;const data = Array.from({ length: totalRows }, (_, i) => ({id: i + 1,name: `Item ${i + 1}`,value: Math.floor(Math.random() * 1000),}));const pageSize = 100;let currentPage = 1;let sortKey = null;let sortAsc = true;const selected = new Set();const wrapper = document.createElement('div');wrapper.className = 'dt-wrapper';const table = document.createElement('table');table.className = 'dt-table';table.setAttribute('role', 'grid');wrapper.appendChild(table);const thead = document.createElement('thead');const headerRow = document.createElement('tr');columns.forEach((col) => {const th = document.createElement('th');th.setAttribute('role', 'columnheader');th.tabIndex = 0;th.dataset.key = col.key;th.innerHTML = `${col.label}<span class="dt-sort"></span>`;th.addEventListener('click', () => {if (sortKey === col.key) {sortAsc = !sortAsc;} else {sortKey = col.key;sortAsc = true;}renderBody();updateSortIcons();});th.addEventListener('keydown', (e) => {if (e.key === 'Enter' || e.key === ' ') {e.preventDefault();th.click();}});headerRow.appendChild(th);});thead.appendChild(headerRow);table.appendChild(thead);const tbody = document.createElement('tbody');table.appendChild(tbody);root.innerHTML = '';root.appendChild(wrapper);const pager = document.createElement('div');pager.className = 'dt-pagination';const prevBtn = document.createElement('button');prevBtn.textContent = 'Prev';const nextBtn = document.createElement('button');nextBtn.textContent = 'Next';const pageInfo = document.createElement('span');pager.appendChild(prevBtn);pager.appendChild(pageInfo);pager.appendChild(nextBtn);root.appendChild(pager);prevBtn.addEventListener('click', () => {if (currentPage > 1) {currentPage--;renderBody();updatePagination();}});nextBtn.addEventListener('click', () => {if (currentPage < Math.ceil(data.length / pageSize)) {currentPage++;renderBody();updatePagination();}});function sortData(arr) {if (!sortKey) return arr;return [...arr].sort((a, b) => {if (a[sortKey] < b[sortKey]) return sortAsc ? -1 : 1;if (a[sortKey] > b[sortKey]) return sortAsc ? 1 : -1;return 0;});}function toggleSelect(id, rowEl) {if (selected.has(id)) {selected.delete(id);rowEl.classList.remove('selected');rowEl.setAttribute('aria-selected', 'false');} else {selected.add(id);rowEl.classList.add('selected');rowEl.setAttribute('aria-selected', 'true');}}function handleRowKey(e) {const row = e.currentTarget;if (e.key === 'ArrowDown') {e.preventDefault();const next = row.nextElementSibling;if (next) next.focus();} else if (e.key === 'ArrowUp') {e.preventDefault();const prev = row.previousElementSibling;if (prev) prev.focus();} else if (e.key === ' ') {e.preventDefault();toggleSelect(Number(row.dataset.id), row);}}function renderBody() {tbody.innerHTML = '';const sorted = sortData(data);const start = (currentPage - 1) * pageSize;const pageRows = sorted.slice(start, start + pageSize);pageRows.forEach((rowData) => {const tr = document.createElement('tr');tr.setAttribute('role', 'row');tr.tabIndex = -1;tr.dataset.id = rowData.id;tr.setAttribute('aria-selected', selected.has(rowData.id) ? 'true' : 'false');if (selected.has(rowData.id)) tr.classList.add('selected');tr.addEventListener('click', () => toggleSelect(rowData.id, tr));tr.addEventListener('keydown', handleRowKey);columns.forEach((col) => {const td = document.createElement('td');td.setAttribute('role', 'gridcell');td.textContent = rowData[col.key];tr.appendChild(td);});tbody.appendChild(tr);});}function updateSortIcons() {thead.querySelectorAll('th').forEach((th) => {th.classList.remove('sort-asc', 'sort-desc');});if (sortKey) {const active = thead.querySelector(`th[data-key="${sortKey}"]`);active.classList.add(sortAsc ? 'sort-asc' : 'sort-desc');}}function updatePagination() {const totalPages = Math.ceil(data.length / pageSize);pageInfo.textContent = `Page ${currentPage} / ${totalPages}`;prevBtn.disabled = currentPage === 1;nextBtn.disabled = currentPage === totalPages;}renderBody();updateSortIcons();updatePagination();}// Auto-init for static and HTMX-loaded contentif (typeof document !== 'undefined') {document.addEventListener('DOMContentLoaded', () => {document.querySelectorAll('[data-component="data-table"]').forEach(initDataTable);});document.body.addEventListener('htmx:load', (e) => {e.target.querySelectorAll('[data-component="data-table"]').forEach(initDataTable);});}