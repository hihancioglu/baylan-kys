{% extends "base.html" %}
{% block title %}Workflow{% endblock %}
{% block content %}
<h1>{{ doc.title }} - Workflow</h1>
{% if workflow %}
<p>Current step: {{ workflow.current_step }}</p>
{% endif %}
{% if steps %}
<table class="table table-striped">
  <thead>
    <tr>
      <th title="Workflow step order">Order</th>
      <th title="Assigned user">User</th>
      <th title="Required role">Role</th>
      <th title="Review or approval type">Type</th>
      <th title="Due date for step">Due</th>
      <th title="Current step status">Status</th>
    </tr>
  </thead>
  <tbody>
    {% for step in steps %}
    <tr{% if workflow and step.step_order == workflow.current_step %} class="table-primary"{% endif %}>
      <td>{{ step.step_order }}</td>
      <td>{{ step.user.username if step.user else '' }}</td>
      <td>{{ step.required_role or '' }}</td>
      <td>{{ step.step_type }}</td>
      <td>{{ step.due_at.strftime('%Y-%m-%d') if step.due_at else '' }}</td>
      <td>{{ step.status }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% else %}
<p>No workflow steps found.</p>
{% endif %}
{% endblock %}
