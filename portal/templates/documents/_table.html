<table class="table table-striped table-sm document-table">
  <colgroup>
      <col style="width:15%">
      <col style="width:15%">
      <col style="width:35%">
      <col style="width:15%">
      <col style="width:20%">
      <col style="width:15%">
      <col style="width:10%">
  </colgroup>
  <thead class="table-light">
      <tr>
        <th style="position:sticky;top:0;">Code</th>
        <th style="position:sticky;top:0;">Standard</th>
        <th style="position:sticky;top:0;">Title</th>
        <th style="position:sticky;top:0;">Status</th>
        <th style="position:sticky;top:0;">Department</th>
        <th style="position:sticky;top:0;">Tags</th>
        <th style="position:sticky;top:0;" class="text-end">Actions</th>
      </tr>
    </thead>
    {% for standard_code, docs in documents|groupby('standard_code') %}
    <tbody data-group="{{ standard_code or 'no-standard' }}">
      <tr class="table-secondary group-toggle">
        <th colspan="7">{{ standard_map.get(standard_code, standard_code or 'No Standard') }}</th>
      </tr>
      {% for doc in docs %}
      <tr>
        <td>{{ doc.code }}</td>
        <td>{{ standard_map.get(doc.standard_code, doc.standard_code) }}</td>
        <td>{{ doc.title }}</td>
        <td><span class="badge badge-status-{{ doc.status|lower }}">{{ doc.status }}</span></td>
        <td>{{ doc.department }}</td>
        <td>{{ doc.tags }}</td>
        <td class="actions">
          <a href="{{ url_for('document_detail', doc_id=doc.id) }}" class="btn btn-sm btn-outline-secondary">View</a>
          {% if doc.status in ['Review', 'Approved'] %}
          <a href="{{ url_for('document_workflow', doc_id=doc.id) }}" class="btn btn-sm btn-outline-secondary">Workflow</a>
          {% else %}
          <span class="btn btn-sm btn-outline-secondary disabled">Workflow</span>
          {% endif %}
          {% if doc.can_download %}
          <a href="{{ url_for('document_download', doc_id=doc.id) }}" class="btn btn-sm btn-outline-secondary">Download</a>
          {% endif %}
          <a href="{{ url_for('document_detail', doc_id=doc.id) }}#uploadVersionModal" class="btn btn-sm btn-outline-secondary">Upload New Version</a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
    {% else %}
    <tbody>
      <tr><td colspan="7">No documents found.</td></tr>
    </tbody>
    {% endfor %}
  </table>
<nav>
  <ul class="pagination">
    {% if page > 1 %}
    <li class="page-item"><a class="page-link" hx-get="{{ url_for('documents_table', page=page-1, **params) }}" hx-target="#document-table" hx-push-url="true">Previous</a></li>
    {% endif %}
    <li class="page-item disabled"><span class="page-link">{{ page }} / {{ pages }}</span></li>
    {% if page < pages %}
    <li class="page-item"><a class="page-link" hx-get="{{ url_for('documents_table', page=page+1, **params) }}" hx-target="#document-table" hx-push-url="true">Next</a></li>
    {% endif %}
  </ul>
</nav>
