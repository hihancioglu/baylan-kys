{% extends "base.html" %}
{% block title %}Documents{% endblock %}
{% block content %}
{% macro table(docs, page, pages, params) %}
<table class="table table-striped">
  <thead>
    <tr>
      <th>Code</th>
      <th>Title</th>
      <th>Status</th>
      <th>Department</th>
      <th>Tags</th>
    </tr>
  </thead>
  <tbody>
    {% for doc in docs %}
    <tr>
      <td>{{ doc.code }}</td>
      <td>{{ doc.title }}</td>
      <td>{{ doc.status }}</td>
      <td>{{ doc.department }}</td>
      <td>{{ doc.tags }}</td>
    </tr>
    {% else %}
    <tr><td colspan="5">No documents found.</td></tr>
    {% endfor %}
  </tbody>
</table>
<nav>
  <ul class="pagination">
    {% if page > 1 %}
    <li class="page-item"><a class="page-link" hx-get="{{ url_for('list_documents', page=page-1, **params) }}" hx-target="#document-table" hx-push-url="true">Previous</a></li>
    {% endif %}
    <li class="page-item disabled"><span class="page-link">{{ page }} / {{ pages }}</span></li>
    {% if page < pages %}
    <li class="page-item"><a class="page-link" hx-get="{{ url_for('list_documents', page=page+1, **params) }}" hx-target="#document-table" hx-push-url="true">Next</a></li>
    {% endif %}
  </ul>
</nav>
{% endmacro %}

{% if partial %}
  {{ table(documents, page, pages, params) }}
{% else %}
<h1>Documents</h1>
<form hx-get="{{ url_for('list_documents') }}" hx-target="#document-table" hx-push-url="true" class="row g-2 mb-3">
  <div class="col-md-2"><input class="form-control" name="code" placeholder="Code" value="{{ filters.code or '' }}"></div>
  <div class="col-md-2"><input class="form-control" name="title" placeholder="Title" value="{{ filters.title or '' }}"></div>
  <div class="col-md-2"><input class="form-control" name="status" placeholder="Status" value="{{ filters.status or '' }}"></div>
  <div class="col-md-2"><input class="form-control" name="department" placeholder="Department" value="{{ filters.department or '' }}"></div>
  <div class="col-md-2"><input class="form-control" name="tag" placeholder="Tag" value="{{ filters.tag or '' }}"></div>
  <div class="col-md-2"><button class="btn btn-primary w-100" type="submit">Filter</button></div>
</form>
<div id="document-table">
  {{ table(documents, page, pages, params) }}
</div>
<script src="{{ asset_url('document_list.js') }}" defer></script>
{% endif %}
{% endblock %}
